<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>EcoPower</title>
    <link rel="icon" type="image/x-icon" href="/project/img/icon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Jersey+25&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="menu.css" />
  </head>
  <body>
    <div class="menu-wrapper">
      <div
        class="menu-panel menu-main"
        role="navigation"
        aria-label="Menu do jogo"
      >
        <h1>EcoPower</h1>

        <div
          class="menu-vertical"
          style="
            display: flex;
            flex-direction: column;
            gap: 14px;
            margin-top: 18px;
            align-items: stretch;
          "
        >
          <a
            class="btn-start"
            id="btnJogar"
            href="#"
            style="display: block; text-align: center"
            >Jogar</a
          >
          <a
            class="btn-secondary"
            id="btnPersonagem"
            href="character.html"
            style="display: block"
            >Personagem</a
          >
          <button class="btn-secondary" id="btnOpcoes" style="display: block">
            Opções
          </button>
        </div>

        <div class="menu-note">
          Use as setas para mover o boneco. Prima <strong>E</strong> para
          interagir com dispositivos próximos.
        </div>
      </div>
    </div>

    <!-- Modal de escolha do modo de jogo -->
    <div
      id="playModal"
      class="modal"
      role="dialog"
      aria-hidden="true"
      aria-labelledby="playTitle"
    >
      <div class="modal-panel" role="document">
        <button class="modal-close" id="playClose" aria-label="Fechar">
          ×
        </button>
        <h3 id="playTitle">Escolher modo</h3>
        <div
          style="
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 10px;
          "
        >
          <a
            id="playChallenge"
            class="btn-start"
            href="index.html#start"
            style="display: block; text-align: center"
            >Desafio — 2 minutos</a
          >
          <a
            id="playSandbox"
            class="btn-secondary"
            href="index.html#sandbox"
            style="display: block; text-align: center"
            >Mundo livre</a
          >
        </div>
        <p style="margin-top: 12px; color: var(--muted); font-size: 13px">
          Escolhe "Desafio" para a partida cronometrada ou "Mundo livre" para
          explorar sem restrições.
        </p>
      </div>
    </div>

    <!-- Modal de opções -->
    <div
      id="optionsModal"
      class="modal"
      role="dialog"
      aria-hidden="true"
      aria-labelledby="optionsTitle"
    >
      <div class="modal-panel" role="document">
        <button class="modal-close" id="optionsClose" aria-label="Fechar">
          ×
        </button>
        <h3 id="optionsTitle">Opções</h3>
        <p>
          Estas são as opções do jogo. Aqui podes activar/desactivar efeitos,
          ajustar o volume ou configurar preferências. Esta é apenas uma
          mensagem informativa de exemplo.
        </p>
        <p style="margin-top: 12px; color: var(--muted); font-size: 13px">
          Fecha esta janela com o botão acima ou clicando fora do painel.
        </p>
      </div>
    </div>

    <script>
      // 'Jogar' abre o modal para escolher o modo; 'Personagem' navega para a seleção de personagem
      const btnJogar = document.getElementById("btnJogar");
      const playModal = document.getElementById("playModal");
      const playClose = document.getElementById("playClose");
      const playChallenge = document.getElementById("playChallenge");
      const playSandbox = document.getElementById("playSandbox");

      const btnPersonagem = document.getElementById("btnPersonagem");
      if (btnPersonagem) {
        btnPersonagem.addEventListener("click", function () {
          window.location.href = "index.html#personagem";
        });
      }

      // 'Opções' abre um modal nesta página
      const btnOp = document.getElementById("btnOpcoes");
      const modal = document.getElementById("optionsModal");
      const modalClose = document.getElementById("optionsClose");

      function showModal() {
        if (!modal) return;
        modal.classList.add("visible");
        modal.setAttribute("aria-hidden", "false");
      }
      function hideModal() {
        if (!modal) return;
        modal.classList.remove("visible");
        modal.setAttribute("aria-hidden", "true");
      }

      btnOp &&
        btnOp.addEventListener("click", function (ev) {
          ev.preventDefault();
          showModal();
        });

      modalClose &&
        modalClose.addEventListener("click", function () {
          hideModal();
        });

      // clicar fora do painel (overlay) fecha o modal
      modal &&
        modal.addEventListener("click", function (ev) {
          if (ev.target === modal) hideModal();
        });

      // Mostrar/ocultar o modal de jogo
      function showPlayModal() {
        if (!playModal) return;
        playModal.classList.add("visible");
        playModal.setAttribute("aria-hidden", "false");
      }
      function hidePlayModal() {
        if (!playModal) return;
        playModal.classList.remove("visible");
        playModal.setAttribute("aria-hidden", "true");
      }

      btnJogar &&
        btnJogar.addEventListener("click", function (ev) {
          ev.preventDefault();
          showPlayModal();
        });

      playClose &&
        playClose.addEventListener("click", function () {
          hidePlayModal();
        });

      // clicar fora do painel fecha
      playModal &&
        playModal.addEventListener("click", function (ev) {
          if (ev.target === playModal) hidePlayModal();
        });

      // opcional: ao clicar numa opção, a navegação fecha o modal de qualquer forma
      playChallenge &&
        playChallenge.addEventListener("click", function () {
          // leave page to index with hash; no extra action needed
        });
      playSandbox &&
        playSandbox.addEventListener("click", function () {
          // leave page to index with hash; no extra action needed
        });
    </script>
  </body>
</html>
